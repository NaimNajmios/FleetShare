<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layouts/renter-layout}" th:with="activePage='home', pageTitle='Home'">

<head>
    <th:block layout:fragment="extra-css">
        <style>
            :root {
                --primary-color: #4B49AC;
                --secondary-color: #7978E9;
                --accent-color: #14b8a6;
                --text-dark: #2C3E50;
                --text-muted: #6c757d;
                --bg-light: #F4F7FA;
            }

            .home-container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 0 1.5rem;
            }

            /* Hero Section */
            .hero-section {
                background: white;
                border-radius: 1.5rem;
                padding: 3rem;
                margin: 2rem 0;
                display: flex;
                align-items: center;
                gap: 3rem;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            }

            .hero-content {
                flex: 1;
            }

            .hero-greeting {
                font-size: 1rem;
                color: var(--accent-color);
                font-weight: 600;
                margin-bottom: 0.5rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }

            .hero-title {
                font-size: 2.5rem;
                font-weight: 700;
                color: var(--text-dark);
                margin-bottom: 1rem;
                line-height: 1.2;
            }

            .hero-subtitle {
                font-size: 1.1rem;
                color: var(--text-muted);
                margin-bottom: 2rem;
                line-height: 1.6;
            }

            .hero-actions {
                display: flex;
                gap: 1rem;
                flex-wrap: wrap;
            }

            .btn-hero-primary {
                background: var(--primary-color);
                color: white;
                padding: 1rem 2rem;
                border-radius: 0.75rem;
                font-weight: 600;
                text-decoration: none;
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                transition: all 0.3s ease;
            }

            .btn-hero-primary:hover {
                background: #3f3e91;
                color: white;
                transform: translateY(-2px);
                box-shadow: 0 8px 20px rgba(75, 73, 172, 0.3);
            }

            .btn-hero-secondary {
                background: #f8f9fa;
                color: var(--text-dark);
                padding: 1rem 2rem;
                border-radius: 0.75rem;
                font-weight: 600;
                text-decoration: none;
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                transition: all 0.3s ease;
                border: 1px solid #e9ecef;
            }

            .btn-hero-secondary:hover {
                background: #e9ecef;
                color: var(--text-dark);
            }

            .hero-image {
                flex: 0.8;
                text-align: center;
            }

            .hero-image i {
                font-size: 8rem;
                color: var(--secondary-color);
                opacity: 0.8;
            }

            /* Quick Actions Grid */
            .quick-actions {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 1.5rem;
                margin-bottom: 2rem;
            }

            .action-card {
                background: white;
                border-radius: 1rem;
                padding: 1.5rem;
                display: flex;
                align-items: center;
                gap: 1rem;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.04);
                transition: all 0.3s ease;
                text-decoration: none;
                color: inherit;
                border: 1px solid transparent;
            }

            .action-card:hover {
                transform: translateY(-4px);
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
                border-color: var(--primary-color);
                color: inherit;
            }

            .action-icon {
                width: 60px;
                height: 60px;
                border-radius: 1rem;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                flex-shrink: 0;
            }

            .action-icon.vehicles {
                background: rgba(75, 73, 172, 0.1);
                color: var(--primary-color);
            }

            .action-icon.bookings {
                background: rgba(20, 184, 166, 0.1);
                color: var(--accent-color);
            }

            .action-icon.profile {
                background: rgba(249, 115, 22, 0.1);
                color: #f97316;
            }

            .action-content h4 {
                font-size: 1.1rem;
                font-weight: 600;
                color: var(--text-dark);
                margin: 0 0 0.25rem 0;
            }

            .action-content p {
                font-size: 0.875rem;
                color: var(--text-muted);
                margin: 0;
            }

            /* Stats Section */
            .stats-section {
                background: white;
                border-radius: 1.5rem;
                padding: 2rem;
                margin-bottom: 2rem;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.04);
            }

            .stats-header {
                margin-bottom: 1.5rem;
            }

            .stats-header h3 {
                font-size: 1.25rem;
                font-weight: 700;
                color: var(--text-dark);
                margin: 0;
            }

            .stats-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 1.5rem;
            }

            .stat-item {
                text-align: center;
                padding: 1rem;
                background: #f8f9fa;
                border-radius: 1rem;
                transition: transform 0.2s;
            }

            .stat-item:hover {
                transform: translateY(-2px);
                background: #fff;
                box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            }

            .stat-value {
                font-size: 2rem;
                font-weight: 700;
                color: var(--primary-color);
                margin-bottom: 0.25rem;
            }

            .stat-label {
                font-size: 0.875rem;
                color: var(--text-muted);
            }

            /* Recent Activity Section */
            .activity-section {
                background: white;
                border-radius: 1.5rem;
                padding: 2rem;
                margin-bottom: 2rem;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.04);
            }

            .section-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1.5rem;
            }

            .section-header h3 {
                font-size: 1.25rem;
                font-weight: 700;
                color: var(--text-dark);
                margin: 0;
            }

            .section-header a {
                color: var(--primary-color);
                font-weight: 500;
                font-size: 0.9rem;
                text-decoration: none;
            }

            .section-header a:hover {
                text-decoration: underline;
            }

            .empty-activity {
                text-align: center;
                padding: 3rem 2rem;
                color: var(--text-muted);
            }

            .empty-activity i {
                font-size: 3rem;
                color: #dee2e6;
                margin-bottom: 1rem;
            }

            .empty-activity h4 {
                font-weight: 600;
                color: var(--text-dark);
                margin-bottom: 0.5rem;
            }

            .empty-activity p {
                font-size: 0.9rem;
            }

            /* Recent Booking Item */
            .recent-bookings-list {
                display: flex;
                flex-direction: column;
                gap: 1rem;
            }

            .booking-item-card {
                display: block;
                text-decoration: none;
                color: inherit;
                background: white;
                border: 1px solid #f0f0f0;
                border-radius: 1rem;
                padding: 1.25rem;
                transition: all 0.2s ease;
            }

            .booking-item-card:hover {
                background: #fcfcfc;
                border-color: #e9ecef;
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            }

            .booking-item-image {
                width: 80px;
                height: 60px;
                border-radius: 0.5rem;
                overflow: hidden;
                background: #f8f9fa;
                flex-shrink: 0;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .booking-item-image img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

            .booking-item-image i {
                font-size: 1.5rem;
                color: #ced4da;
            }

            .status-badge-small {
                padding: 0.25rem 0.6rem;
                border-radius: 50px;
                font-size: 0.7rem;
                font-weight: 700;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .status-pending { background: #fff8e1; color: #b7791f; }
            .status-confirmed { background: #e3f2fd; color: #1976d2; }
            .status-active { background: #e0f2f1; color: #00897b; }
            .status-completed { background: #e8f5e9; color: #2e7d32; }
            .status-cancelled { background: #ffebee; color: #c62828; }

            /* Responsive */
            @media (max-width: 768px) {
                .hero-section {
                    flex-direction: column;
                    text-align: center;
                    padding: 2rem;
                }

                .hero-title {
                    font-size: 1.75rem;
                }

                .hero-image {
                    display: none;
                }

                .hero-actions {
                    justify-content: center;
                }
            }
        </style>
    </th:block>
</head>

<body>
    <main layout:fragment="content">
        <div class="home-container">
            <!-- Hero Section -->
            <div class="hero-section">
                <div class="hero-content">
                    <div class="hero-greeting">
                        <i class="fas fa-hand-wave"></i>
                        <span th:text="${greeting}">Hello</span>
                    </div>
                    <h1 class="hero-title" th:text="'Welcome back, ' + ${userName} + '!'">Welcome back!</h1>
                    <p class="hero-subtitle">
                        Find and book your perfect vehicle for any occasion. Browse our wide selection of cars from
                        verified fleet owners.
                    </p>
                    <div class="hero-actions">
                        <a href="/renter/vehicles" class="btn-hero-primary">
                            <i class="fas fa-search"></i> Browse Vehicles
                        </a>
                        <a href="/renter/bookings" class="btn-hero-secondary">
                            <i class="fas fa-calendar"></i> My Bookings
                        </a>
                    </div>
                </div>
                <div class="hero-image">
                    <i class="fas fa-car-side"></i>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <a href="/renter/vehicles" class="action-card">
                    <div class="action-icon vehicles">
                        <i class="fas fa-car"></i>
                    </div>
                    <div class="action-content">
                        <h4>Browse Vehicles</h4>
                        <p>Explore available cars for rent</p>
                    </div>
                </a>

                <a href="/renter/bookings" class="action-card">
                    <div class="action-icon bookings">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="action-content">
                        <h4>My Bookings</h4>
                        <p>View and manage your reservations</p>
                    </div>
                </a>

                <a href="/renter/profile" class="action-card">
                    <div class="action-icon profile">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="action-content">
                        <h4>My Profile</h4>
                        <p>Update your personal details</p>
                    </div>
                </a>
            </div>

            <!-- Stats Overview -->
            <div class="stats-section">
                <div class="stats-header">
                    <h3><i class="fas fa-chart-bar"></i> Your Activity</h3>
                </div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" th:text="${totalBookings != null ? totalBookings : 0}">0</div>
                        <div class="stat-label">Total Bookings</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" th:text="${activeBookings != null ? activeBookings : 0}">0</div>
                        <div class="stat-label">Active Rentals</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" th:text="${completedBookings != null ? completedBookings : 0}">0</div>
                        <div class="stat-label">Completed</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" th:text="${pendingBookings != null ? pendingBookings : 0}">0</div>
                        <div class="stat-label">Pending</div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="activity-section">
                <div class="section-header">
                    <h3><i class="fas fa-history"></i> Recent Bookings</h3>
                    <a href="/renter/bookings">View All</a>
                </div>

                <div th:if="${recentBookings == null or #lists.isEmpty(recentBookings)}" class="empty-activity">
                    <i class="fas fa-calendar-alt"></i>
                    <h4>No Recent Activity</h4>
                    <p>Start by browsing available vehicles and make your first booking!</p>
                </div>

                <!-- Recent Bookings List -->
                <div th:unless="${recentBookings == null or #lists.isEmpty(recentBookings)}" class="recent-bookings-list">
                    <div th:each="booking : ${recentBookings}" class="position-relative">
                        <a th:href="@{/renter/bookings/{id}(id=${booking.bookingId})}" class="booking-item-card stretched-link">
                            <div class="d-flex align-items-center gap-3">
                                <!-- Image -->
                                <div class="booking-item-image">
                                     <img th:if="${booking.vehicleImageUrl != null and !booking.vehicleImageUrl.isEmpty()}"
                                        th:src="${booking.vehicleImageUrl}" alt="Vehicle">
                                    <i th:unless="${booking.vehicleImageUrl != null and !booking.vehicleImageUrl.isEmpty()}"
                                        class="fas fa-car"></i>
                                </div>

                                <!-- Info -->
                                <div class="flex-grow-1">
                                    <div class="d-flex justify-content-between align-items-start mb-1">
                                        <div>
                                            <h6 class="mb-0 fw-bold text-dark" th:text="${booking.vehicleBrand + ' ' + booking.vehicleModel}">Vehicle Name</h6>
                                            <small class="text-muted" th:text="'Booking #' + ${booking.bookingId}">#123</small>
                                        </div>
                                        <span class="status-badge-small"
                                              th:classappend="${'status-' + booking.status.toLowerCase()}"
                                              th:text="${booking.status}">STATUS</span>
                                    </div>
                                    <div class="d-flex align-items-center gap-3 mt-2 text-muted small">
                                         <div>
                                            <i class="fas fa-calendar-alt me-1"></i>
                                            <span th:text="${#temporals.format(booking.startDate, 'dd MMM')} + ' - ' + ${#temporals.format(booking.endDate, 'dd MMM')}">Dates</span>
                                         </div>
                                         <div th:if="${booking.totalCost != null}">
                                            <i class="fas fa-tag me-1"></i>
                                            <span th:text="'RM ' + ${booking.totalCost}">Cost</span>
                                         </div>
                                    </div>
                                </div>

                                <!-- Chevron -->
                                <div class="d-none d-sm-block text-muted">
                                    <i class="fas fa-chevron-right"></i>
                                </div>
                            </div>
                        </a>

                        <!-- Quick Action for Pending Bookings (Z-index above stretched link) -->
                        <div th:if="${booking.status == 'PENDING'}" class="position-absolute end-0 bottom-0 mb-3 me-3 z-2">
                             <a th:href="@{/renter/bookings/{id}/payment(id=${booking.bookingId})}"
                                class="btn btn-sm btn-primary rounded-pill px-3 shadow-sm">
                                <i class="fas fa-credit-card me-1"></i> Pay
                             </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <th:block layout:fragment="extra-js">
        <script>
            // Any home page specific JS can go here
        </script>
    </th:block>
</body>

</html>
